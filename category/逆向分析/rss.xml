<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>Faceless Blog • Posts by &#34;逆向分析&#34; category</title>
        <link>https://haysalan.github.io</link>
        <description>数据采集、逆向安全、网络杂谈</description>
        <language>zh-CN</language>
        <pubDate>Wed, 03 Jan 2024 10:13:01 +0000</pubDate>
        <lastBuildDate>Wed, 03 Jan 2024 10:13:01 +0000</lastBuildDate>
        <category>AST</category>
        <category>解混淆</category>
        <category>nodejs</category>
        <category>build</category>
        <category>frida</category>
        <category>jnitrace</category>
        <category>objection</category>
        <category>GitHub</category>
        <category>Actions</category>
        <category>TLS/SSL</category>
        <category>JA3</category>
        <category>JA4</category>
        <category>证书</category>
        <category>magisk</category>
        <category>andorid</category>
        <category>fastboot</category>
        <category>root</category>
        <category>charles</category>
        <category>抓包</category>
        <category>加速乐</category>
        <category>思路</category>
        <category>SO</category>
        <category>Native</category>
        <category>入门级</category>
        <category>windows</category>
        <category>资源</category>
        <category>疑难杂症</category>
        <category>hexo</category>
        <item>
            <guid isPermalink="true">https://haysalan.github.io/posts/50605.html</guid>
            <title>破解tap验证和绕过实名认证</title>
            <link>https://haysalan.github.io/posts/50605.html</link>
            <category>入门级</category>
            <pubDate>Wed, 03 Jan 2024 10:13:01 +0000</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;案例目标&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#案例目标&#34;&gt;#&lt;/a&gt; 案例目标&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;去除账号验证&lt;/li&gt;
&lt;li&gt;去除实名认证&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;环境准备&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#环境准备&#34;&gt;#&lt;/a&gt; 环境准备&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;MT 管理器 / NP 管理器&lt;/li&gt;
&lt;li&gt;JEB/jadx（非必须）&lt;/li&gt;
&lt;li&gt;模拟器 / 安卓手机&lt;/li&gt;
&lt;li&gt;root （否）&lt;/li&gt;
&lt;li&gt;目标 APP&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;破解步骤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#破解步骤&#34;&gt;#&lt;/a&gt; 破解步骤&lt;/h2&gt;
&lt;h3 id=&#34;绕过账号验证&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#绕过账号验证&#34;&gt;#&lt;/a&gt; 绕过账号验证&lt;/h3&gt;
&lt;p&gt;开启 MT 管理器的 Activity 记录功能&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671602359155-c9ae5dc8-85b5-4231-94fb-a928eebcc0c3.png#averageHue=%23cac9c9&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=ucdad7e8c&amp;amp;originHeight=1206&amp;amp;originWidth=668&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=101736&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u51237a12-77fe-4d3d-965c-d5df7542f11&amp;amp;title=&#34; alt=&#34;微信截图_20221221135907.png&#34;&gt;&lt;br&gt;
 启动成功后打开我们需要破解的 APP，他会启动游戏平台验证账号，我们回到游戏就会看到下面的页面。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671602498061-e1426d46-45a5-4fac-8ebb-49e5ec366acb.png#averageHue=%23444444&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=u3e40e4a9&amp;amp;originHeight=739&amp;amp;originWidth=1356&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=67608&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u99f86d7f-d114-47aa-930c-33fcc39d0c5&amp;amp;title=&#34; alt=&#34;微信截图_20221221140124.png&#34;&gt;&lt;br&gt;
 进入 MT 管理器查看记录，最后的一个活动是 com.txxxxx.pay.sdk.library.TxxAlertDialog$1，那我们从它开始入手。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671602303415-c37264f8-df26-4454-8352-0e8e41a313b3.png#averageHue=%23c3c2c1&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=udfc026cc&amp;amp;originHeight=1298&amp;amp;originWidth=694&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=254366&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=udeaa1633-8f16-4d99-b3e5-929efbf8e92&amp;amp;title=&#34; alt=&#34;微信截图_20221221135806.png&#34;&gt;&lt;br&gt;
 找到这个类 com.txxxxx.pay.sdk.library.TxxAlertDialog&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671602871407-6ceb3b75-f65e-4c41-a429-95200bfad7db.png#averageHue=%23e7e3d7&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=u889397ae&amp;amp;originHeight=933&amp;amp;originWidth=1552&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=217684&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u45e25c5f-8765-4e4b-b9ff-fb14a6c7468&amp;amp;title=&#34; alt=&#34;微信截图_20221221140729.png&#34;&gt;&lt;br&gt;
 我们得到 new 它的地方。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671604604483-60b1bd9d-b7cc-4af6-bf09-65691a2f9037.png#averageHue=%23eae1d5&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=u8c895e75&amp;amp;originHeight=1079&amp;amp;originWidth=1567&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=211722&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ub2a5a9fd-f775-4796-add0-aad888f41b9&amp;amp;title=&#34; alt=&#34;微信截图_20221221143612.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;进入并分析一下。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671604759903-d6ad0476-9c68-4d05-8aac-7d5923ba3f27.png#averageHue=%23f3ebe3&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=u090dbc25&amp;amp;originHeight=1087&amp;amp;originWidth=1452&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=164088&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u121839ec-ce4b-4c71-99a3-a029bfa5e81&amp;amp;title=&#34; alt=&#34;微信截图_20221221143852.png&#34;&gt;&lt;br&gt;
 搜索一下哪里调用了销毁弹窗，验证通过必定需要销毁，找起来更快。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671604904388-35ec8f2a-0648-4fd1-89b0-2c81b69bf9bf.png#averageHue=%23f4f0ee&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=ueca1eb4e&amp;amp;originHeight=693&amp;amp;originWidth=1496&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=62436&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u9a91e773-032a-466e-962d-90dcc2a5958&amp;amp;title=&#34; alt=&#34;微信截图_20221221144127.png&#34;&gt;&lt;br&gt;
 进入分析一下。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671605052168-84dd2bde-fb9f-473e-b107-f74923303f3e.png#averageHue=%23f8f2f1&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=u72643f64&amp;amp;originHeight=366&amp;amp;originWidth=1450&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=56786&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u6055ff4c-1c26-4b48-b25b-074bf528857&amp;amp;title=&#34; alt=&#34;微信截图_20221221144342.png&#34;&gt;&lt;br&gt;
 看看哪里还个调用了&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671605447575-ce5982d8-35b3-43ef-9d78-260b576d4406.png#averageHue=%23f3f0ea&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=u2d5ce57b&amp;amp;originHeight=916&amp;amp;originWidth=1535&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=107223&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u40fd5ad3-e7ba-48b1-abcd-d2f0a1bed06&amp;amp;title=&#34; alt=&#34;微信截图_20221221145005.png&#34;&gt;&lt;br&gt;
 这里我验证过了，修改它们即可去除验证。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671605720530-3d2f6cd3-821d-4a38-9577-472b65688caa.png#averageHue=%23faf5f4&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=u7e1cfcac&amp;amp;originHeight=1141&amp;amp;originWidth=1406&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=122503&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u859a70bf-d132-46f9-bf73-82676b18f83&amp;amp;title=&#34; alt=&#34;微信截图_20221221145500.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;快速定位关键字 &lt;code&gt;checkLicense = licensed&lt;/code&gt;  (不出意外只有一个结果)&lt;br&gt;
 然后搜索定位函数 checkLicense&lt;br&gt;
 在 smali 代码中修改对应的值就能去除验证了。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671532241058-89eb95d0-d5a6-4f7d-81c1-cdbc7457985b.png#averageHue=%23fdfaf9&amp;amp;clientId=u5760c920-5b5f-4&amp;amp;from=drop&amp;amp;id=FZP8r&amp;amp;originHeight=1176&amp;amp;originWidth=1672&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=170926&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ue6c970bb-1886-4050-b0ae-6bbb13fcdac&amp;amp;title=&#34; alt=&#34;微信截图_20221220183011.png&#34;&gt;&lt;br&gt;
 重新签名安装后启动看看效果吧。&lt;/p&gt;
&lt;h3 id=&#34;绕过实名认证&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#绕过实名认证&#34;&gt;#&lt;/a&gt; 绕过实名认证&lt;/h3&gt;
&lt;p&gt;开启 MT 管理器的 Activity 记录功能，然后启动 APP 弹出实名弹窗之后回到 MT 管理器，可以看到只有一个 Activity -&amp;gt;  &lt;code&gt;com.lixxthgame.abi.UnityPlayerActivity&lt;/code&gt; &lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671588848878-0441652c-c8a9-49fa-b4b6-b8e7486d6fed.png#averageHue=%238b8a8a&amp;amp;clientId=u2e0d459e-147d-4&amp;amp;from=ui&amp;amp;id=ua42b506b&amp;amp;originHeight=1121&amp;amp;originWidth=678&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=166629&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u8cdbd2c8-dbd3-4305-96f6-d6b64c57410&amp;amp;title=&#34; alt=&#34;Snipaste_2022-12-21_10-11-13.png&#34;&gt;&lt;br&gt;
 在 UnityPlayerActivity 中并没发现什么可疑的地方，那就得找新的办法了。&lt;br&gt;
我们来试试新的关键字 “identify”，需要实名认证，估计会使用这个单词。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671593032964-ab95b599-8b44-4474-a4fb-6bfb0b60ecca.png#averageHue=%23ebe8e5&amp;amp;clientId=u2e0d459e-147d-4&amp;amp;from=ui&amp;amp;id=u058e6d36&amp;amp;originHeight=1153&amp;amp;originWidth=1581&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=231954&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ue65d47f3-f7d1-40f0-95f9-8c11014a99e&amp;amp;title=&#34; alt=&#34;微信截图_20221221112340.png&#34;&gt;&lt;br&gt;
 看看这个 IdentifyHelp 类是干什么用的。&lt;/p&gt;
&lt;p&gt;IdentifyHelp 中有个方法 CompareTimeUp18 翻译过来就是 对比年龄到 18（估计是用出生日期和当前时间对比）&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671593371902-50de2adf-4bde-4121-8ec3-741a4df678aa.png#averageHue=%23fbf7f6&amp;amp;clientId=u2e0d459e-147d-4&amp;amp;from=ui&amp;amp;id=u537bd713&amp;amp;originHeight=346&amp;amp;originWidth=1456&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=40390&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=uec1358ce-5d27-46fa-a000-cc3c94241fe&amp;amp;title=&#34; alt=&#34;微信截图_20221221112821.png&#34;&gt;&lt;br&gt;
 看看那些地方调用了 CompareTimeUp18&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671593917788-ab9501b3-bda6-4746-aabf-699cbb8c4681.png#averageHue=%23f1eeeb&amp;amp;clientId=u2e0d459e-147d-4&amp;amp;from=ui&amp;amp;id=u4a635499&amp;amp;originHeight=1148&amp;amp;originWidth=1582&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=133303&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u9aa9b69b-708f-401f-899d-6116db127f1&amp;amp;title=&#34; alt=&#34;微信截图_20221221113824.png&#34;&gt;&lt;br&gt;
 选择第一个，进入到方法 antiAddication，分析一下。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671595264762-5395591c-b7fa-42f5-b365-4d8dc36208e1.png#averageHue=%23f7f1ef&amp;amp;clientId=u2e0d459e-147d-4&amp;amp;from=ui&amp;amp;id=u8027d24a&amp;amp;originHeight=959&amp;amp;originWidth=1449&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=164814&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ub95c164f-e498-45d0-b5e7-2c8198e9239&amp;amp;title=&#34; alt=&#34;微信截图_20221221120045.png&#34;&gt;&lt;br&gt;
 进入 setBigMan 或 setIdenfity 中&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671594735893-520b3df9-6c33-41b1-8eba-59e9feab47ba.png#averageHue=%23fcf8f7&amp;amp;clientId=u2e0d459e-147d-4&amp;amp;from=ui&amp;amp;id=u483aba0b&amp;amp;originHeight=1064&amp;amp;originWidth=995&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=83011&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=uccd0dc22-b3dc-44bb-b67e-ae4e734b216&amp;amp;title=&#34; alt=&#34;微信截图_20221221115204.png&#34;&gt;&lt;br&gt;
 将 isBigMan 和 isIdenfity 的初始值置为 true 即可去实名认证了。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671591338615-f3e424d9-7255-40c5-b067-160fd53e9272.png#averageHue=%23fbf9f9&amp;amp;clientId=u2e0d459e-147d-4&amp;amp;from=ui&amp;amp;id=D2g7d&amp;amp;originHeight=1087&amp;amp;originWidth=979&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=101242&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u48e415f1-34d6-4730-a542-f28400787b2&amp;amp;title=&#34; alt=&#34;微信截图_20221221105523.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;在 smali 代码中修改对应的值就能去除验证了。&lt;br&gt;
快速定位关键字  &lt;code&gt;LoaclUser&amp;#123;name=&lt;/code&gt;  (不出意外只有一个结果)&lt;br&gt;
 搜索定位 isIdenfity&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671591845525-464035cb-38f4-480d-8e91-8375683bb4a5.png#averageHue=%23fdf3f1&amp;amp;clientId=u2e0d459e-147d-4&amp;amp;from=ui&amp;amp;id=UGMOJ&amp;amp;originHeight=511&amp;amp;originWidth=1513&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=71430&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ua65fb48e-9e12-4d70-85f9-5dd795a4a49&amp;amp;title=&#34; alt=&#34;微信截图_20221221110343.png&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://haysalan.github.io/posts/26899.html</guid>
            <title>小破站老版本（入门级）SO层Native方法分析</title>
            <link>https://haysalan.github.io/posts/26899.html</link>
            <category>frida</category>
            <category>SO</category>
            <category>Native</category>
            <category>入门级</category>
            <pubDate>Sat, 09 Dec 2023 01:25:03 +0000</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;准备工作&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#准备工作&#34;&gt;#&lt;/a&gt; 准备工作&lt;/h1&gt;
&lt;p&gt;APK：哔哩哔哩 6.13.0&lt;br&gt;
 首先通过 charles 抓包（&lt;a href=&#34;/2023/12/14/yuque/charles%E7%A7%BB%E5%8A%A8&amp;amp;PC%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/&#34;&gt;charles 抓包配置&lt;/a&gt;）发现加密参数是 sign（32 位）。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1702545110875-4f85f617-f9b8-41f3-a026-5225f1ecb6fa.png#averageHue=%23efebe7&amp;amp;clientId=u38bf89dd-3cf3-4&amp;amp;from=paste&amp;amp;height=182&amp;amp;id=ud746971e&amp;amp;originHeight=273&amp;amp;originWidth=699&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=27817&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u0382f2ee-b150-43bf-8767-3f42b87f7c9&amp;amp;title=&amp;amp;width=466&#34; alt=&#34;image.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;使用 ajdx 打开 apk 后搜索 &amp;quot;sign&amp;quot; 并没有想要的数据，接着试着搜索 &amp;quot;sign=&amp;quot; 经过分析发现是 &lt;code&gt;com.bilibili.nativelibrary.LibBili.s&lt;/code&gt;  生成。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1702546159027-aa401add-1412-4a36-85ec-25f0ed79ab6b.png#averageHue=%23fdf8f6&amp;amp;clientId=u38bf89dd-3cf3-4&amp;amp;from=paste&amp;amp;height=341&amp;amp;id=ubff81967&amp;amp;originHeight=512&amp;amp;originWidth=873&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=36640&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ua7d5337b-80c2-4ec6-9747-241d38418ae&amp;amp;title=&amp;amp;width=582&#34; alt=&#34;image.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;验证加密&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#验证加密&#34;&gt;#&lt;/a&gt; 验证加密&lt;/h1&gt;
&lt;p&gt;使用 frida 来 hook 验证以下&lt;/p&gt;
&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;hookSign&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;title class_&#34;&gt;Java&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;perform&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; (&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;LibBili&lt;/span&gt; = &lt;span class=&#34;title class_&#34;&gt;Java&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;use&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;com.bilibili.nativelibrary.LibBili&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;title class_&#34;&gt;LibBili&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;quot;s&amp;quot;&lt;/span&gt;].&lt;span class=&#34;property&#34;&gt;implementation&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; (&lt;span class=&#34;params&#34;&gt;sortedMap&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;variable language_&#34;&gt;console&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;log&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;string&#34;&gt;`LibBili.s is called: sortedMap=&lt;span class=&#34;subst&#34;&gt;$&amp;#123;sortedMap.entrySet().toArray()&amp;#125;&lt;/span&gt;`&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; result = &lt;span class=&#34;variable language_&#34;&gt;this&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;quot;s&amp;quot;&lt;/span&gt;](sortedMap);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;variable language_&#34;&gt;console&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;log&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;`LibBili.s result=&lt;span class=&#34;subst&#34;&gt;$&amp;#123;result&amp;#125;&lt;/span&gt;`&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; result;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_&#34;&gt;setImmediate&lt;/span&gt;(hookSign);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;frida hook 日志，很明显 sign 就是在这里面生成的。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;[MI 8 Pro::tv.danmaku.bili ]-&amp;gt; LibBili.s is called: sortedMap=access_key=null,appkey=1d8b6e7d45233436,build=6130400,c_locale=zh-Hans_CN,channel=xxl_wyyd_001,mVersion=71,mallVersion=6130400,mobi_app=android,platform=android,s_locale=zh-Hans_CN,statistics=&amp;#123;&amp;quot;appId&amp;quot;:1,&amp;quot;platform&amp;quot;:3,&amp;quot;version&amp;quot;:&amp;quot;6.13.0&amp;quot;,&amp;quot;abtest&amp;quot;:&amp;quot;&amp;quot;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;LibBili.s result=access_key=&amp;amp;appkey=1d8b6e7d45233436&amp;amp;build=6130400&amp;amp;c_locale=zh-Hans_CN&amp;amp;channel=xxl_wyyd_001&amp;amp;mVersion=71&amp;amp;mallVersion=6130400&amp;amp;mobi_app=android&amp;amp;platform=android&amp;amp;s_locale=zh-Hans_CN&amp;amp;statistics=%7B%22appId%22%3A1%2C%22platform%22%3A3%2C%22version%22%3A%226.13.0%22%2C%22abtest%22%3A%22%22%7D&amp;amp;ts=1702547190&amp;amp;sign=83c0620895711a111a4fc8f046b76d9d&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&#34;定位-so&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#定位-so&#34;&gt;#&lt;/a&gt; 定位 SO&lt;/h1&gt;
&lt;p&gt;使用大佬的&lt;a href=&#34;https://github.com/lasting-yang/frida_hook_libart/blob/master/hook_RegisterNatives.js&#34;&gt; hook 脚本&lt;/a&gt;并作了点修改&lt;/p&gt;
&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;hook_RegisterNatives&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; symbols = &lt;span class=&#34;title class_&#34;&gt;Module&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;enumerateSymbolsSync&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;libart.so&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; addrRegisterNatives = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; symbols.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt;; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; symbol = symbols[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//_ZN3art3JNI15RegisterNativesEP7_JNIEnvP7_jclassPK15JNINativeMethodi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      symbol.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;indexOf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;art&amp;quot;&lt;/span&gt;) &amp;gt;= &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      symbol.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;indexOf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;JNI&amp;quot;&lt;/span&gt;) &amp;gt;= &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      symbol.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;indexOf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;RegisterNatives&amp;quot;&lt;/span&gt;) &amp;gt;= &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      symbol.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;indexOf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;CheckJNI&amp;quot;&lt;/span&gt;) &amp;lt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      addrRegisterNatives = symbol.&lt;span class=&#34;property&#34;&gt;address&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;variable language_&#34;&gt;console&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;log&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;RegisterNatives is at &amp;quot;&lt;/span&gt;, symbol.&lt;span class=&#34;property&#34;&gt;address&lt;/span&gt;, symbol.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (addrRegisterNatives != &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;title class_&#34;&gt;Interceptor&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;attach&lt;/span&gt;(addrRegisterNatives, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;attr&#34;&gt;onEnter&lt;/span&gt;: &lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; (&lt;span class=&#34;params&#34;&gt;args&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; env = args[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; java_class = args[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; class_name = &lt;span class=&#34;title class_&#34;&gt;Java&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;vm&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;tryGetEnv&lt;/span&gt;().&lt;span class=&#34;title function_&#34;&gt;getClassName&lt;/span&gt;(java_class);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// console.log(class_name);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// 筛选类&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; taget_class = &lt;span class=&#34;string&#34;&gt;&amp;quot;com.bilibili.nativelibrary.LibBili&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (class_name === taget_class) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              &lt;span class=&#34;variable language_&#34;&gt;console&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;log&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;\n[RegisterNatives] method_count:&amp;quot;&lt;/span&gt;, args[&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; methods_ptr = &lt;span class=&#34;title function_&#34;&gt;ptr&lt;/span&gt;(args[&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; method_count = &lt;span class=&#34;built_in&#34;&gt;parseInt&lt;/span&gt;(args[&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; method_count; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; name_ptr = &lt;span class=&#34;title class_&#34;&gt;Memory&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;readPointer&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  methods_ptr.&lt;span class=&#34;title function_&#34;&gt;add&lt;/span&gt;(i * &lt;span class=&#34;title class_&#34;&gt;Process&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;pointerSize&lt;/span&gt; * &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; sig_ptr = &lt;span class=&#34;title class_&#34;&gt;Memory&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;readPointer&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  methods_ptr.&lt;span class=&#34;title function_&#34;&gt;add&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    i * &lt;span class=&#34;title class_&#34;&gt;Process&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;pointerSize&lt;/span&gt; * &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt; + &lt;span class=&#34;title class_&#34;&gt;Process&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;pointerSize&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; fnPtr_ptr = &lt;span class=&#34;title class_&#34;&gt;Memory&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;readPointer&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  methods_ptr.&lt;span class=&#34;title function_&#34;&gt;add&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    i * &lt;span class=&#34;title class_&#34;&gt;Process&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;pointerSize&lt;/span&gt; * &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt; + &lt;span class=&#34;title class_&#34;&gt;Process&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;pointerSize&lt;/span&gt; * &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; name = &lt;span class=&#34;title class_&#34;&gt;Memory&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;readCString&lt;/span&gt;(name_ptr);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; sig = &lt;span class=&#34;title class_&#34;&gt;Memory&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;readCString&lt;/span&gt;(sig_ptr);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; find_module = &lt;span class=&#34;title class_&#34;&gt;Process&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;findModuleByAddress&lt;/span&gt;(fnPtr_ptr);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable language_&#34;&gt;console&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;log&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  &lt;span class=&#34;string&#34;&gt;&amp;quot;[RegisterNatives] java_class:&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  class_name,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  &lt;span class=&#34;string&#34;&gt;&amp;quot;name:&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  name,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  &lt;span class=&#34;string&#34;&gt;&amp;quot;sig:&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  sig,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  &lt;span class=&#34;string&#34;&gt;&amp;quot;fnPtr:&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  fnPtr_ptr,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  &lt;span class=&#34;string&#34;&gt;&amp;quot;module_name:&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  find_module.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  &lt;span class=&#34;string&#34;&gt;&amp;quot;module_base:&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  find_module.&lt;span class=&#34;property&#34;&gt;base&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  &lt;span class=&#34;string&#34;&gt;&amp;quot;offset:&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  &lt;span class=&#34;title function_&#34;&gt;ptr&lt;/span&gt;(fnPtr_ptr).&lt;span class=&#34;title function_&#34;&gt;sub&lt;/span&gt;(find_module.&lt;span class=&#34;property&#34;&gt;base&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_&#34;&gt;setImmediate&lt;/span&gt;(hook_RegisterNatives);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;添加筛选条件后输出的结果不多&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Spawning `tv.danmaku.bili`...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;RegisterNatives is at  0xf0b3cbd9 _ZN3art3JNIILb0EE15RegisterNativesEP7_JNIEnvP7_jclassPK15JNINativeMethodi&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;RegisterNatives is at  0xf0b910d5 _ZN3art3JNIILb1EE15RegisterNativesEP7_JNIEnvP7_jclassPK15JNINativeMethodi&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Spawned `tv.danmaku.bili`. Resuming main thread!&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[MI 8 Pro::tv.danmaku.bili ]-&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] method_count: 0x7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] java_class: com.bilibili.nativelibrary.LibBili name: a sig: (Ljava/lang/String;)Ljava/lang/String; fnPtr: 0xb8369c35 module_name: libbili.so module_base: 0xb8368000 offset: 0x1c35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] java_class: com.bilibili.nativelibrary.LibBili name: ao sig: (Ljava/lang/String;II)Ljava/lang/String; fnPtr: 0xb8369c3b module_name: libbili.so module_base: 0xb8368000 offset: 0x1c3b&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] java_class: com.bilibili.nativelibrary.LibBili name: b sig: (Ljava/lang/String;)Ljavax/crypto/spec/IvParameterSpec; fnPtr: 0xb8369c49 module_name: libbili.so module_base: 0xb8368000 offset: 0x1c49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] java_class: com.bilibili.nativelibrary.LibBili name: s sig: (Ljava/util/SortedMap;)Lcom/bilibili/nativelibrary/SignedQuery; fnPtr: 0xb8369c4f module_name: libbili.so module_base: 0xb8368000 offset: 0x1c4f&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] java_class: com.bilibili.nativelibrary.LibBili name: so sig: (Ljava/util/SortedMap;II)Lcom/bilibili/nativelibrary/SignedQuery; fnPtr: 0xb8369c55 module_name: libbili.so module_base: 0xb8368000 offset: 0x1c55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] java_class: com.bilibili.nativelibrary.LibBili name: getCpuCount sig: ()I fnPtr: 0xb8369c63 module_name: libbili.so module_base: 0xb8368000 offset: 0x1c63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] java_class: com.bilibili.nativelibrary.LibBili name: getCpuId sig: ()I fnPtr: 0xb8369c67 module_name: libbili.so module_base: 0xb8368000 offset: 0x1c67&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这就是我们需要的结果，module_name: &lt;a href=&#34;http://libbili.so&#34;&gt;libbili.so&lt;/a&gt; 表示 s 函数在 &lt;strong&gt;&lt;a href=&#34;http://libbili.so&#34;&gt;libbili.so&lt;/a&gt;&lt;/strong&gt; 中。&lt;br&gt;
offset: 0x1c4f 偏移量为 0x1c4f 可以理解为函数起始地址。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] java_class: com.bilibili.nativelibrary.LibBili name: s sig: (Ljava/util/SortedMap;)Lcom/bilibili/nativelibrary/SignedQuery; fnPtr: 0xb8369c4f module_name: libbili.so module_base: 0xb8368000 offset: 0x1c4f&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&#34;分析-so&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#分析-so&#34;&gt;#&lt;/a&gt; 分析 SO&lt;/h1&gt;
&lt;p&gt;使用&lt;strong&gt; file&lt;/strong&gt; 命令查看 so 的位数是多少位，可以看到是 32 位的，那么使用 32 位的 ida 打开。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1702545860250-d8c98fed-5255-4a16-947a-c16016a59d92.png#averageHue=%232e3039&amp;amp;clientId=u38bf89dd-3cf3-4&amp;amp;from=paste&amp;amp;height=72&amp;amp;id=u4365b7e2&amp;amp;originHeight=108&amp;amp;originWidth=1195&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=31218&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=uae38cbac-a117-4898-9e10-2e4569eeff4&amp;amp;title=&amp;amp;width=796.6666666666666&#34; alt=&#34;image.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;偏移量地址定位函数&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#偏移量地址定位函数&#34;&gt;#&lt;/a&gt; 偏移量地址定位函数&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/gif/26634545/1702550208616-9e78b5a6-c72b-4f48-bd9f-75b6684b755b.gif#averageHue=%23f7f7f6&amp;amp;clientId=u26f63c50-11da-4&amp;amp;from=drop&amp;amp;id=u1e1c6921&amp;amp;originHeight=1328&amp;amp;originWidth=2053&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=454668&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ua43a4d49-06e5-478f-ac28-235419421ac&amp;amp;title=&#34; alt=&#34;PixPin_2023-12-14_18-36-22.gif&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;jni_onload-定位-s-函数&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#jni_onload-定位-s-函数&#34;&gt;#&lt;/a&gt; JNI_OnLoad 定位 s 函数&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/gif/26634545/1702550232510-9c4a4843-75f5-4fce-a183-770783c0dddb.gif#averageHue=%23f6f6f5&amp;amp;clientId=u26f63c50-11da-4&amp;amp;from=drop&amp;amp;id=u5aefa470&amp;amp;originHeight=1328&amp;amp;originWidth=2053&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=792808&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u3e2d9528-de56-415e-9185-2b963fb96eb&amp;amp;title=&#34; alt=&#34;PixPin_2023-12-14_18-32-47.gif&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://haysalan.github.io/posts/59917.html</guid>
            <title>加速乐逆向</title>
            <link>https://haysalan.github.io/posts/59917.html</link>
            <category>解混淆</category>
            <category>加速乐</category>
            <pubDate>Wed, 08 Nov 2023 09:00:04 +0000</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;声明&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#声明&#34;&gt;#&lt;/a&gt; 声明&lt;/h1&gt;
&lt;p&gt;本逆向文章仅为学术交流和学习探讨之用，不代表任何官方立场或观点。文章内容仅供参考，读者应自行判断其真实性和可靠性。因使用本逆向文章而产生的任何直接或间接后果，本网站及作者不承担任何法律责任。请在使用本逆向文章前仔细阅读相关法律法规和条款，并确保您理解并接受本免责声明的全部内容。如有侵权行为或不当使用，请及时联系我们，我们将尽快处理。&lt;/p&gt;
&lt;h1 id=&#34;逻辑分析&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#逻辑分析&#34;&gt;#&lt;/a&gt; 逻辑分析&lt;/h1&gt;
&lt;p&gt;1.index.html 请求中有如下图两个 cookies。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1699435260379-8d57aed7-a002-4c53-900a-8e901924ed55.png#averageHue=%23eecd94&amp;amp;clientId=u282ecbe5-2f8d-4&amp;amp;from=paste&amp;amp;height=361&amp;amp;id=ub58af60e&amp;amp;originHeight=541&amp;amp;originWidth=1211&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=56461&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u407de983-9f7e-4f3f-9701-d447caf96f7&amp;amp;title=&amp;amp;width=807.3333333333334&#34; alt=&#34;image.png&#34;&gt; 2. 使用 charles 或其他抓包工具进行抓包，看到 index.html 进过三次加载，前两次是 521 状态。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1699435667713-255995fd-4aff-406e-ac33-4affeb7e17de.png#averageHue=%23f7e1de&amp;amp;clientId=u282ecbe5-2f8d-4&amp;amp;from=paste&amp;amp;height=136&amp;amp;id=u23357e78&amp;amp;originHeight=204&amp;amp;originWidth=865&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=31079&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u60a45c58-ce2e-4a95-b867-0424086eb04&amp;amp;title=&amp;amp;width=576.6666666666666&#34; alt=&#34;image.png&#34;&gt; 3. 第一次请求的  &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt;  标签中进行了 cookie 设置，cookie 值如图是被混淆的。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1699435810175-43c64164-fe6d-4413-8154-30811e494725.png#averageHue=%23f6efee&amp;amp;clientId=u282ecbe5-2f8d-4&amp;amp;from=paste&amp;amp;height=325&amp;amp;id=ufda357d2&amp;amp;originHeight=487&amp;amp;originWidth=1180&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=45801&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ue94fa2eb-52a9-4c17-8129-1701b682529&amp;amp;title=&amp;amp;width=786.6666666666666&#34; alt=&#34;image.png&#34;&gt;&lt;br&gt;
 放到浏览器控制台中执行得到如下结果，发现 cookie 的 name 和成功响应带的 cookie 一致。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1699436504827-0fb474f3-f3eb-4741-8d17-d1b5599d2edb.png#averageHue=%23faf7f4&amp;amp;clientId=u282ecbe5-2f8d-4&amp;amp;from=paste&amp;amp;height=102&amp;amp;id=ud13a1a5c&amp;amp;originHeight=153&amp;amp;originWidth=1214&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=28179&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u3aaeb1cd-a0c5-40f1-bcd0-174321fdc63&amp;amp;title=&amp;amp;width=809.3333333333334&#34; alt=&#34;image.png&#34;&gt; 4. 第二次请求带上来第一次请求的 cookies-**jsl_clearance_s, 返回结果应该经过 ob 混淆的代码。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1699436659042-6623654a-c89e-417c-b09b-a69ac47db90e.png#averageHue=%23f5efed&amp;amp;clientId=u282ecbe5-2f8d-4&amp;amp;from=paste&amp;amp;height=468&amp;amp;id=u24249c79&amp;amp;originHeight=702&amp;amp;originWidth=1434&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=104332&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u5a8a3feb-42d2-41de-8ac6-e2571ee4df5&amp;amp;title=&amp;amp;width=956&#34; alt=&#34;image.png&#34;&gt; 5. 第三次成功响应，对比 cookies 发现，**jsl_clearance_s 变了，大概率是 ob 混淆文件对它做了修改。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1699436842758-691796cb-f12c-49cf-b8da-52cc6d5694cc.png#averageHue=%23f7f2f1&amp;amp;clientId=u282ecbe5-2f8d-4&amp;amp;from=paste&amp;amp;height=411&amp;amp;id=u95876b19&amp;amp;originHeight=616&amp;amp;originWidth=1418&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=81899&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u50247f49-082d-40ec-be6f-152b6dcebad&amp;amp;title=&amp;amp;width=945.3333333333334&#34; alt=&#34;image.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;请求实现&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#请求实现&#34;&gt;#&lt;/a&gt; 请求实现&lt;/h1&gt;
&lt;p&gt;解完混淆代码逻辑清晰可见&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1699457082391-e396b4e4-0e34-4777-92d8-863d062d2dcb.png#averageHue=%23292e36&amp;amp;clientId=u797940c7-3ac3-4&amp;amp;from=paste&amp;amp;height=614&amp;amp;id=u6af0785e&amp;amp;originHeight=767&amp;amp;originWidth=1102&amp;amp;originalType=binary%E2%88%B6=1.25&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=131952&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u2c86d18d-ec14-47c7-86c5-e9540582e6e&amp;amp;title=&amp;amp;width=881.6&#34; alt=&#34;image.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;python-请求代码&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#python-请求代码&#34;&gt;#&lt;/a&gt; python 请求代码&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1699463090349-47df0f08-cc99-4b35-8fd4-294c07c81c4f.png#averageHue=%232d2c2c&amp;amp;clientId=u797940c7-3ac3-4&amp;amp;from=paste&amp;amp;height=515&amp;amp;id=u996c474e&amp;amp;originHeight=644&amp;amp;originWidth=772&amp;amp;originalType=binary%E2%88%B6=1.25&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=77500&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u3f430bd5-7c7c-4867-9ee6-e759fdfc7f9&amp;amp;title=&amp;amp;width=617.6&#34; alt=&#34;image.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;完整代码仓库: &lt;a href=&#34;https://github.com/Alanhays/crawler/tree/main/SCDN_JSL&#34;&gt;https://github.com/Alanhays/crawler&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://haysalan.github.io/posts/6066.html</guid>
            <title>400行代码解混淆猿人学第二届第三题然后进行完美反编译</title>
            <link>https://haysalan.github.io/posts/6066.html</link>
            <category>AST</category>
            <category>解混淆</category>
            <pubDate>Mon, 16 Oct 2023 02:43:09 +0000</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;题目&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#题目&#34;&gt;#&lt;/a&gt; 题目&lt;/h2&gt;
&lt;p&gt;猿人学 2023 届第三题 &lt;a href=&#34;https://match2023.yuanrenxue.cn/topic/3&#34;&gt;点击跳转&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;0x01-降维打击&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#0x01-降维打击&#34;&gt;#&lt;/a&gt; 0x01 降维打击&lt;/h2&gt;
&lt;p&gt;这里 if 都是多层嵌套的，非常影响阅读体验，直接一步将它变为一维结构吧！&lt;/p&gt;
&lt;p&gt;还原前先手动还原小部分代码，接着写反混淆脚本批量修改。&lt;br&gt;
我们单看  &lt;code&gt;if (o &amp;lt; 2)&lt;/code&gt;  这个 if 块，很明显 &lt;code&gt;o &amp;lt; 1&lt;/code&gt;  其实就是 &lt;code&gt;o==0&lt;/code&gt;  而 else 就是  &lt;code&gt;o==1&lt;/code&gt; , 以此类推。&lt;/p&gt;
&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; (&lt;span class=&#34;params&#34;&gt;e&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; o = e || &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (;;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (o &amp;lt; &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (o &amp;lt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        o += &lt;span class=&#34;number&#34;&gt;88&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        v.&lt;span class=&#34;property&#34;&gt;v&lt;/span&gt; = !&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        o += &lt;span class=&#34;number&#34;&gt;226&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (o &amp;lt; &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        o += &lt;span class=&#34;number&#34;&gt;243&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        L = Y || l.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        o += &lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;)();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// 手动还原一下 还原如下&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; (&lt;span class=&#34;params&#34;&gt;e&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; o = e || &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;switch&lt;/span&gt; (o) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      o += &lt;span class=&#34;number&#34;&gt;88&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      v.&lt;span class=&#34;property&#34;&gt;v&lt;/span&gt; = !&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      o += &lt;span class=&#34;number&#34;&gt;226&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      o += &lt;span class=&#34;number&#34;&gt;243&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      L = Y || l.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      o += &lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;)();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这是我写的插件，将&lt;strong&gt;多层嵌套的 if&lt;/strong&gt; 转换为&lt;strong&gt; Switch&lt;/strong&gt; 语法，可以方便我们后续调试。&lt;/p&gt;
&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;IfToCase&lt;/span&gt; = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;title class_&#34;&gt;IfStatement&lt;/span&gt;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;title function_&#34;&gt;exit&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;path, state&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; &amp;#123; test, consequent, alternate &amp;#125; = path.&lt;span class=&#34;property&#34;&gt;node&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; &amp;#123; name, cases &amp;#125; = state;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// 如果 test 不是 o &amp;lt; 数字，则不进行处理&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!types.&lt;span class=&#34;title function_&#34;&gt;isBinaryExpression&lt;/span&gt;(test, &amp;#123; &lt;span class=&#34;attr&#34;&gt;operator&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;lt;&amp;quot;&lt;/span&gt; &amp;#125;)) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!types.&lt;span class=&#34;title function_&#34;&gt;isIdentifier&lt;/span&gt;(test.&lt;span class=&#34;property&#34;&gt;left&lt;/span&gt;, &amp;#123; &lt;span class=&#34;attr&#34;&gt;name&lt;/span&gt;: name &amp;#125;)) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!types.&lt;span class=&#34;title function_&#34;&gt;isNumericLiteral&lt;/span&gt;(test.&lt;span class=&#34;property&#34;&gt;right&lt;/span&gt;)) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// alternate.body.push(types.BreakStatement());&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// consequent.body.push(types.BreakStatement());&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; right = test.&lt;span class=&#34;property&#34;&gt;right&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;value&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (right % &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt; === &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// 处理 else 不是 if 节点的情况&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (types.&lt;span class=&#34;title function_&#34;&gt;isIfStatement&lt;/span&gt;(alternate.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;])) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        cases.&lt;span class=&#34;title function_&#34;&gt;push&lt;/span&gt;(types.&lt;span class=&#34;title class_&#34;&gt;SwitchCase&lt;/span&gt;(types.&lt;span class=&#34;title function_&#34;&gt;valueToNode&lt;/span&gt;(right), alternate.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;comment&#34;&gt;// 构建 case 节点&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; case1 = types.&lt;span class=&#34;title class_&#34;&gt;SwitchCase&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        types.&lt;span class=&#34;title function_&#34;&gt;valueToNode&lt;/span&gt;(right - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        consequent.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; case2 = types.&lt;span class=&#34;title class_&#34;&gt;SwitchCase&lt;/span&gt;(types.&lt;span class=&#34;title function_&#34;&gt;valueToNode&lt;/span&gt;(right), alternate.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      cases.&lt;span class=&#34;title function_&#34;&gt;push&lt;/span&gt;(case1, case2);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;IfToSwitch&lt;/span&gt; = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;title class_&#34;&gt;ForStatement&lt;/span&gt;(path) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; &amp;#123; init, test, update, body &amp;#125; = path.&lt;span class=&#34;property&#34;&gt;node&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; prev = path.&lt;span class=&#34;title function_&#34;&gt;getPrevSibling&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!types.&lt;span class=&#34;title function_&#34;&gt;isIfStatement&lt;/span&gt;(body)) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; discriminant = prev.&lt;span class=&#34;property&#34;&gt;node&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;declarations&lt;/span&gt;[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;].&lt;span class=&#34;property&#34;&gt;id&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; cases = [];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    path.&lt;span class=&#34;title function_&#34;&gt;traverse&lt;/span&gt;(&lt;span class=&#34;title class_&#34;&gt;IfToCase&lt;/span&gt;, &amp;#123; &lt;span class=&#34;attr&#34;&gt;name&lt;/span&gt;: discriminant.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;, &lt;span class=&#34;attr&#34;&gt;cases&lt;/span&gt;: cases &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!cases.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt;) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; switchNode = types.&lt;span class=&#34;title class_&#34;&gt;SwitchStatement&lt;/span&gt;(discriminant, cases);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    path.&lt;span class=&#34;title function_&#34;&gt;get&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;body&amp;quot;&lt;/span&gt;).&lt;span class=&#34;title function_&#34;&gt;replaceInline&lt;/span&gt;(switchNode);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;对比效果图如下，处理后清晰了不少。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1697529594404-f77481eb-28cb-4bd3-a926-b635f89cec30.png#averageHue=%232d2c2b&amp;amp;clientId=u4e46a870-c294-4&amp;amp;from=paste&amp;amp;height=600&amp;amp;id=u3da4d467&amp;amp;originHeight=900&amp;amp;originWidth=793&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=85853&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u014f1895-cac3-4715-9e8f-d28dfece6e6&amp;amp;title=&amp;amp;width=528.6666666666666&#34; alt=&#34;image.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;0x02-打回原形&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#0x02-打回原形&#34;&gt;#&lt;/a&gt; 0x02 打回原形&lt;/h2&gt;
&lt;p&gt;经过上一步还原后发现有很多  &lt;code&gt;o += xx | o -= xx&lt;/code&gt;  的代码，这里的 o 其实就是 case 的条件，那么简化一下吧！ &lt;code&gt;o = o - xxx&lt;/code&gt;  其中  &lt;code&gt;o - xxx &lt;/code&gt; 部分我们计算出来。&lt;br&gt;
下面插件来喽！又香又脆，嘎嘎香！&lt;/p&gt;
&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;RestoreJump&lt;/span&gt; = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;title class_&#34;&gt;AssignmentExpression&lt;/span&gt;(path) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; &amp;#123; operator, left, right &amp;#125; = path.&lt;span class=&#34;property&#34;&gt;node&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!(operator[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;] === &lt;span class=&#34;string&#34;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; &amp;amp;&amp;amp; types.&lt;span class=&#34;title function_&#34;&gt;isNumericLiteral&lt;/span&gt;(right))) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; caseNode = path.&lt;span class=&#34;title function_&#34;&gt;findParent&lt;/span&gt;(&lt;span class=&#34;function&#34;&gt;(&lt;span class=&#34;params&#34;&gt;p&lt;/span&gt;) =&amp;gt;&lt;/span&gt; p.&lt;span class=&#34;title function_&#34;&gt;isSwitchCase&lt;/span&gt;());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; &amp;#123; consequent, test &amp;#125; = caseNode.&lt;span class=&#34;property&#34;&gt;node&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// 构建 ast 节点  o -= xxx  改为 o - xxx ,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; _node = types.&lt;span class=&#34;title function_&#34;&gt;assignmentExpression&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;string&#34;&gt;&amp;quot;=&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      left,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      types.&lt;span class=&#34;title function_&#34;&gt;valueToNode&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        operator[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;] === &lt;span class=&#34;string&#34;&gt;&amp;quot;-&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          ? test.&lt;span class=&#34;property&#34;&gt;value&lt;/span&gt; - right.&lt;span class=&#34;property&#34;&gt;value&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          : test.&lt;span class=&#34;property&#34;&gt;value&lt;/span&gt; + right.&lt;span class=&#34;property&#34;&gt;value&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    path.&lt;span class=&#34;title function_&#34;&gt;replaceInline&lt;/span&gt;(_node);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;对比效果图如下，处理后清晰了不少。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1697529672556-f653bcaa-08df-4fb3-b4ab-8d5a3c43d8cc.png#averageHue=%232e2c2b&amp;amp;clientId=u4e46a870-c294-4&amp;amp;from=paste&amp;amp;height=596&amp;amp;id=u2d646e55&amp;amp;originHeight=894&amp;amp;originWidth=703&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=60103&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=uef9a602b-f747-4522-8474-fa12e9ce0bc&amp;amp;title=&amp;amp;width=468.6666666666667&#34; alt=&#34;image.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;0x03-迷阵寻踪&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#0x03-迷阵寻踪&#34;&gt;#&lt;/a&gt; 0x03 迷阵寻踪&lt;/h2&gt;
&lt;p&gt;经过上面还原后 发现很多 case 块只做 o 的修改，那我就知道它下一步要到那个 case 块，唉！我们是不是可以将他们合并起来，插件如下&lt;/p&gt;
&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;105&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;getJump&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;node, name&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!types.&lt;span class=&#34;title function_&#34;&gt;isExpressionStatement&lt;/span&gt;(node)) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; &amp;#123; expression &amp;#125; = node;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!types.&lt;span class=&#34;title function_&#34;&gt;isAssignmentExpression&lt;/span&gt;(expression)) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (expression.&lt;span class=&#34;property&#34;&gt;left&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt; !== name) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; expression.&lt;span class=&#34;property&#34;&gt;right&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;value&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;getCaseJump&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;map, name, node&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; &amp;#123; test, consequent &amp;#125; = node;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; list = [];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; con = consequent[consequent.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt; - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; num = &lt;span class=&#34;title function_&#34;&gt;getJump&lt;/span&gt;(con, name);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (num !== &lt;span class=&#34;literal&#34;&gt;undefined&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    list.&lt;span class=&#34;title function_&#34;&gt;push&lt;/span&gt;(num);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (types.&lt;span class=&#34;title function_&#34;&gt;isIfStatement&lt;/span&gt;(con)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; &amp;#123; consequent, alternate &amp;#125; = con;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; num = &lt;span class=&#34;title function_&#34;&gt;getJump&lt;/span&gt;(consequent, name);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (num !== &lt;span class=&#34;literal&#34;&gt;undefined&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      list.&lt;span class=&#34;title function_&#34;&gt;push&lt;/span&gt;(num);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    num = &lt;span class=&#34;title function_&#34;&gt;getJump&lt;/span&gt;(alternate, name);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (num !== &lt;span class=&#34;literal&#34;&gt;undefined&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      list.&lt;span class=&#34;title function_&#34;&gt;push&lt;/span&gt;(num);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  map[test.&lt;span class=&#34;property&#34;&gt;value&lt;/span&gt;] = list;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;removeDuplicates&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;arr1, arr2&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; result = []; &lt;span class=&#34;comment&#34;&gt;// 存储删除的元素的数组&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; arr1.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt;; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; found = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; j = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; j &amp;lt; arr2.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt;; j++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (arr1[i] === arr2[j]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        result.&lt;span class=&#34;title function_&#34;&gt;push&lt;/span&gt;(arr1[i]); &lt;span class=&#34;comment&#34;&gt;// 将相同的元素存储到结果数组中&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        arr2.&lt;span class=&#34;title function_&#34;&gt;splice&lt;/span&gt;(j, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;// 删除arr2中的相同元素&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        found = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (found) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      arr1.&lt;span class=&#34;title function_&#34;&gt;splice&lt;/span&gt;(i, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;// 删除arr1中的相同元素&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      i--; &lt;span class=&#34;comment&#34;&gt;// 由于删除了元素，需要调整索引&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; result;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;controlFlowStructure&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;si, map, cases, stack = [], body = []&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!map.&lt;span class=&#34;property&#34;&gt;loop&lt;/span&gt;) map.&lt;span class=&#34;property&#34;&gt;loop&lt;/span&gt; = [];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (stack.&lt;span class=&#34;title function_&#34;&gt;includes&lt;/span&gt;(si)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (map.&lt;span class=&#34;property&#34;&gt;loop&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;indexOf&lt;/span&gt;(si) === -&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;) map.&lt;span class=&#34;property&#34;&gt;loop&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;push&lt;/span&gt;(si);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; body;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; item = map[si];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  body = body.&lt;span class=&#34;title function_&#34;&gt;concat&lt;/span&gt;(cases[si].&lt;span class=&#34;property&#34;&gt;consequent&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;switch&lt;/span&gt; (item.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; body;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;controlFlowStructure&lt;/span&gt;(item[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;], map, cases, stack, body);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      stack.&lt;span class=&#34;title function_&#34;&gt;push&lt;/span&gt;(si);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      body[body.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt; - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;].&lt;span class=&#34;property&#34;&gt;consequent&lt;/span&gt; = types.&lt;span class=&#34;title function_&#34;&gt;blockStatement&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;title function_&#34;&gt;controlFlowStructure&lt;/span&gt;(item[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;], map, cases, stack, [])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (map.&lt;span class=&#34;property&#34;&gt;loop&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;includes&lt;/span&gt;(si)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; &amp;#123; test, consequent &amp;#125; = body[body.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt; - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        body[body.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt; - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;] = types.&lt;span class=&#34;title function_&#34;&gt;whileStatement&lt;/span&gt;(test, consequent);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        body = body.&lt;span class=&#34;title function_&#34;&gt;concat&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;title function_&#34;&gt;controlFlowStructure&lt;/span&gt;(item[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], map, cases, stack, [])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        body[body.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt; - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;].&lt;span class=&#34;property&#34;&gt;alternate&lt;/span&gt; = types.&lt;span class=&#34;title function_&#34;&gt;blockStatement&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;title function_&#34;&gt;controlFlowStructure&lt;/span&gt;(item[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], map, cases, stack, [])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        body = body.&lt;span class=&#34;title function_&#34;&gt;concat&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;title function_&#34;&gt;removeDuplicates&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            body[body.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt; - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;].&lt;span class=&#34;property&#34;&gt;consequent&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            body[body.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt; - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;].&lt;span class=&#34;property&#34;&gt;alternate&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      stack.&lt;span class=&#34;title function_&#34;&gt;pop&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; body;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;MergeCases&lt;/span&gt; = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;title class_&#34;&gt;SwitchStatement&lt;/span&gt;(path) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; &amp;#123; discriminant, cases &amp;#125; = path.&lt;span class=&#34;property&#34;&gt;node&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; name = discriminant.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; binding = path.&lt;span class=&#34;property&#34;&gt;scope&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;getBinding&lt;/span&gt;(name);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; start = binding.&lt;span class=&#34;property&#34;&gt;path&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;node&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;init&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;right&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;value&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; map = &amp;#123;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; cases.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt;; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;title function_&#34;&gt;getCaseJump&lt;/span&gt;(map, name, cases[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    path.&lt;span class=&#34;title function_&#34;&gt;replaceInline&lt;/span&gt;(&lt;span class=&#34;title function_&#34;&gt;controlFlowStructure&lt;/span&gt;(start, map, cases));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;对比图如下，都有实质的代码了。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1702450260705-b76c8b0a-fafb-4898-b521-5585ee9afd08.png#averageHue=%23282c35&amp;amp;clientId=uddd9945d-4384-4&amp;amp;from=paste&amp;amp;height=580&amp;amp;id=u70489b23&amp;amp;originHeight=870&amp;amp;originWidth=982&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=72814&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=uf6a01b16-e0e2-4689-b78b-590527a8fe4&amp;amp;title=&amp;amp;width=654.6666666666666&#34; alt=&#34;image.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;0x04-移除污秽&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#0x04-移除污秽&#34;&gt;#&lt;/a&gt; 0x04 移除污秽&lt;/h2&gt;
&lt;p&gt;将指针修改的代码去除&lt;/p&gt;
&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;CleaningUpGarbage&lt;/span&gt; = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;title class_&#34;&gt;ForStatement&lt;/span&gt;(path) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; p = path.&lt;span class=&#34;title function_&#34;&gt;getPrevSibling&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; name = p.&lt;span class=&#34;property&#34;&gt;node&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;declarations&lt;/span&gt;[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;].&lt;span class=&#34;property&#34;&gt;id&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    path.&lt;span class=&#34;property&#34;&gt;scope&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;traverse&lt;/span&gt;(path.&lt;span class=&#34;property&#34;&gt;scope&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;block&lt;/span&gt;, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;title class_&#34;&gt;AssignmentExpression&lt;/span&gt;(_path) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!types.&lt;span class=&#34;title function_&#34;&gt;isIdentifier&lt;/span&gt;(_path.&lt;span class=&#34;property&#34;&gt;node&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;left&lt;/span&gt;, &amp;#123; &lt;span class=&#34;attr&#34;&gt;name&lt;/span&gt;: name &amp;#125;)) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        _path.&lt;span class=&#34;title function_&#34;&gt;remove&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;移除无关代码&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1702450286996-5f3bb3ba-428f-44a6-b967-0193166a5738.png#averageHue=%23282c35&amp;amp;clientId=uddd9945d-4384-4&amp;amp;from=paste&amp;amp;height=583&amp;amp;id=ua6aaac7e&amp;amp;originHeight=875&amp;amp;originWidth=997&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=77990&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=uff6ec970-1dac-4d57-9924-5237cb19abd&amp;amp;title=&amp;amp;width=664.6666666666666&#34; alt=&#34;image.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;0x05-结构优化&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#0x05-结构优化&#34;&gt;#&lt;/a&gt; 0x05 结构优化&lt;/h2&gt;
&lt;p&gt;优化 ifelse 结构，使其更便于阅读。&lt;/p&gt;
&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;isEndNode&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;nodes&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; typeList = [&lt;span class=&#34;string&#34;&gt;&amp;quot;ReturnStatement&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;ThrowStatement&amp;quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; nodes.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt;; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (typeList.&lt;span class=&#34;title function_&#34;&gt;includes&lt;/span&gt;(nodes[i].&lt;span class=&#34;property&#34;&gt;type&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; ifOptimization = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;title class_&#34;&gt;IfStatement&lt;/span&gt;(path) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; &amp;#123; test, consequent, alternate &amp;#125; = path.&lt;span class=&#34;property&#34;&gt;node&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!alternate) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;title function_&#34;&gt;isEndNode&lt;/span&gt;(consequent.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      path.&lt;span class=&#34;title function_&#34;&gt;insertAfter&lt;/span&gt;(alternate.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      path.&lt;span class=&#34;property&#34;&gt;node&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;alternate&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;title function_&#34;&gt;isEndNode&lt;/span&gt;(alternate.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      path.&lt;span class=&#34;title function_&#34;&gt;insertAfter&lt;/span&gt;(consequent.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      path.&lt;span class=&#34;title function_&#34;&gt;replaceInline&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        types.&lt;span class=&#34;title function_&#34;&gt;ifStatement&lt;/span&gt;(types.&lt;span class=&#34;title function_&#34;&gt;unaryExpression&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;!&amp;quot;&lt;/span&gt;, test), alternate, &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      types.&lt;span class=&#34;title function_&#34;&gt;isIfStatement&lt;/span&gt;(consequent.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;[consequent.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt; - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]) &amp;amp;&amp;amp;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;title function_&#34;&gt;isEndNode&lt;/span&gt;(consequent.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;[consequent.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt; - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;].&lt;span class=&#34;property&#34;&gt;consequent&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;title function_&#34;&gt;generator&lt;/span&gt;(alternate.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;]).&lt;span class=&#34;property&#34;&gt;code&lt;/span&gt; ===&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;title function_&#34;&gt;generator&lt;/span&gt;(consequent.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;[consequent.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt; - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;].&lt;span class=&#34;property&#34;&gt;alternate&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          .&lt;span class=&#34;property&#34;&gt;code&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        path.&lt;span class=&#34;title function_&#34;&gt;insertAfter&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          consequent.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;[consequent.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt; - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;].&lt;span class=&#34;property&#34;&gt;alternate&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        consequent.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;[consequent.&lt;span class=&#34;property&#34;&gt;body&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt; - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;].&lt;span class=&#34;property&#34;&gt;alternate&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        path.&lt;span class=&#34;property&#34;&gt;node&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;alternate&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;处理后逻辑尽现。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1702450320593-e2b95e6e-9e76-4844-b667-6eec93d04bd7.png#averageHue=%23282c35&amp;amp;clientId=uddd9945d-4384-4&amp;amp;from=paste&amp;amp;height=588&amp;amp;id=u230434df&amp;amp;originHeight=882&amp;amp;originWidth=1014&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=76020&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u0b9addc3-37d0-4bd2-86a2-c9edb2476e6&amp;amp;title=&amp;amp;width=676&#34; alt=&#34;image.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;0x06-答辩还原&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#0x06-答辩还原&#34;&gt;#&lt;/a&gt; 0x06 答辩还原&lt;/h2&gt;
&lt;p&gt;这里其实就是嵌套的三元表达式，先手动还原几条能发现他本质是 switch&lt;/p&gt;
&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;TernaryToSwitch&lt;/span&gt; = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;title class_&#34;&gt;ConditionalExpression&lt;/span&gt;(path, &amp;#123; cases, _name &amp;#125;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; &amp;#123; test, consequent, alternate &amp;#125; = path.&lt;span class=&#34;property&#34;&gt;node&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!types.&lt;span class=&#34;title function_&#34;&gt;isBinaryExpression&lt;/span&gt;(test, &amp;#123; &lt;span class=&#34;attr&#34;&gt;operator&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;==&amp;quot;&lt;/span&gt; &amp;#125;)) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; &amp;#123; right, left &amp;#125; = test;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!types.&lt;span class=&#34;title function_&#34;&gt;isIdentifier&lt;/span&gt;(right) || !types.&lt;span class=&#34;title function_&#34;&gt;isNumericLiteral&lt;/span&gt;(left)) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!cases[right.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      cases[right.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;] = [];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; body = [&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      types.&lt;span class=&#34;title function_&#34;&gt;expressionStatement&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        types.&lt;span class=&#34;title function_&#34;&gt;assignmentExpression&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;=&amp;quot;&lt;/span&gt;, types.&lt;span class=&#34;title function_&#34;&gt;identifier&lt;/span&gt;(_name), consequent)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      ),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    body.&lt;span class=&#34;title function_&#34;&gt;push&lt;/span&gt;(types.&lt;span class=&#34;title function_&#34;&gt;breakStatement&lt;/span&gt;());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    cases[right.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;].&lt;span class=&#34;title function_&#34;&gt;push&lt;/span&gt;(types.&lt;span class=&#34;title function_&#34;&gt;switchCase&lt;/span&gt;(test.&lt;span class=&#34;property&#34;&gt;left&lt;/span&gt;, body));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;TernaryReturn&lt;/span&gt; = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;title class_&#34;&gt;ReturnStatement&lt;/span&gt;(path) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; &amp;#123; argument &amp;#125; = path.&lt;span class=&#34;property&#34;&gt;node&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!types.&lt;span class=&#34;title function_&#34;&gt;isConditionalExpression&lt;/span&gt;(argument)) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!types.&lt;span class=&#34;title function_&#34;&gt;isBinaryExpression&lt;/span&gt;(argument.&lt;span class=&#34;property&#34;&gt;test&lt;/span&gt;, &amp;#123; &lt;span class=&#34;attr&#34;&gt;operator&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;==&amp;quot;&lt;/span&gt; &amp;#125;)) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; cases = &amp;#123;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; name = argument.&lt;span class=&#34;property&#34;&gt;test&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;right&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!name) &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; _name = &lt;span class=&#34;string&#34;&gt;`&lt;span class=&#34;subst&#34;&gt;$&amp;#123;name&amp;#125;&lt;/span&gt;&lt;span class=&#34;subst&#34;&gt;$&amp;#123;path.node.start&amp;#125;&lt;/span&gt;`&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    path.&lt;span class=&#34;title function_&#34;&gt;traverse&lt;/span&gt;(&lt;span class=&#34;title class_&#34;&gt;TernaryToSwitch&lt;/span&gt;, &amp;#123; &lt;span class=&#34;attr&#34;&gt;cases&lt;/span&gt;: cases, &lt;span class=&#34;attr&#34;&gt;_name&lt;/span&gt;: _name &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    path.&lt;span class=&#34;title function_&#34;&gt;insertBefore&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      types.&lt;span class=&#34;title function_&#34;&gt;variableDeclaration&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;var&amp;quot;&lt;/span&gt;, [&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        types.&lt;span class=&#34;title function_&#34;&gt;variableDeclarator&lt;/span&gt;(types.&lt;span class=&#34;title function_&#34;&gt;identifier&lt;/span&gt;(_name), &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      ])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    path.&lt;span class=&#34;title function_&#34;&gt;replaceInline&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      types.&lt;span class=&#34;title function_&#34;&gt;switchStatement&lt;/span&gt;(types.&lt;span class=&#34;title function_&#34;&gt;identifier&lt;/span&gt;(name), cases[name])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    path.&lt;span class=&#34;title function_&#34;&gt;insertAfter&lt;/span&gt;(types.&lt;span class=&#34;title function_&#34;&gt;returnStatement&lt;/span&gt;(types.&lt;span class=&#34;title function_&#34;&gt;identifier&lt;/span&gt;(_name)));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;对比效果图如下，处理后犹如拨云见日，茅塞顿开。（还原它主要是为了反编译 jsvmp）&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1702450426324-2d914a7e-900f-43bc-bf20-8a9354955a72.png#averageHue=%232c313a&amp;amp;clientId=uddd9945d-4384-4&amp;amp;from=paste&amp;amp;height=448&amp;amp;id=u07f8273d&amp;amp;originHeight=672&amp;amp;originWidth=1775&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=229439&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u9bf7aed3-541a-42df-964a-21462f220ef&amp;amp;title=&amp;amp;width=1183.3333333333333&#34; alt=&#34;image.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;0x07-窥探本源&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#0x07-窥探本源&#34;&gt;#&lt;/a&gt; 0x07 窥探本源&lt;/h2&gt;
&lt;p&gt;反编译后魔改点与环境检测清晰可见&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1702451095343-fda949dc-020d-4397-9c0e-9d372de2e24b.png#averageHue=%23282c34&amp;amp;clientId=uddd9945d-4384-4&amp;amp;from=paste&amp;amp;height=731&amp;amp;id=ubf805d6c&amp;amp;originHeight=1096&amp;amp;originWidth=1907&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=242373&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u75d2dc46-b601-49b0-8235-27796f97c3a&amp;amp;title=&amp;amp;width=1271.3333333333333&#34; alt=&#34;image.png&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1702451229487-9bdf0c20-397c-428f-8fe4-0bc1250ebc6b.png#averageHue=%23282c34&amp;amp;clientId=uddd9945d-4384-4&amp;amp;from=paste&amp;amp;height=219&amp;amp;id=uac3d94c8&amp;amp;originHeight=329&amp;amp;originWidth=1127&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=46466&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u6f65b94a-3b3f-458a-98e4-5292b347083&amp;amp;title=&amp;amp;width=751.3333333333334&#34; alt=&#34;image.png&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1702451251011-f97b6dac-f961-4a76-bf51-5d4661a47d64.png#averageHue=%23282d35&amp;amp;clientId=uddd9945d-4384-4&amp;amp;from=paste&amp;amp;height=605&amp;amp;id=u8d9ac5cb&amp;amp;originHeight=907&amp;amp;originWidth=962&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=112361&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ude973f5a-0882-4236-8fbb-c9ec825411d&amp;amp;title=&amp;amp;width=641.3333333333334&#34; alt=&#34;image.png&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1702451267059-47cac11c-8d64-43fe-859a-8aee47d83335.png#averageHue=%23282d36&amp;amp;clientId=uddd9945d-4384-4&amp;amp;from=paste&amp;amp;height=763&amp;amp;id=u201636c1&amp;amp;originHeight=1144&amp;amp;originWidth=1310&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=160926&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ucee3950c-1f24-4cd7-8a6e-642435ff9aa&amp;amp;title=&amp;amp;width=873.3333333333334&#34; alt=&#34;image.png&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
    </channel>
</rss>
