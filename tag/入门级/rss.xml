<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>Faceless Blog • Posts by &#34;入门级&#34; tag</title>
        <link>https://haysalan.github.io</link>
        <description>数据采集、逆向安全、网络杂谈</description>
        <language>zh-CN</language>
        <pubDate>Wed, 03 Jan 2024 10:13:01 +0000</pubDate>
        <lastBuildDate>Wed, 03 Jan 2024 10:13:01 +0000</lastBuildDate>
        <category>AST</category>
        <category>解混淆</category>
        <category>nodejs</category>
        <category>build</category>
        <category>frida</category>
        <category>jnitrace</category>
        <category>objection</category>
        <category>GitHub</category>
        <category>Actions</category>
        <category>TLS/SSL</category>
        <category>JA3</category>
        <category>JA4</category>
        <category>证书</category>
        <category>magisk</category>
        <category>andorid</category>
        <category>fastboot</category>
        <category>root</category>
        <category>charles</category>
        <category>抓包</category>
        <category>加速乐</category>
        <category>思路</category>
        <category>SO</category>
        <category>Native</category>
        <category>入门级</category>
        <category>windows</category>
        <category>资源</category>
        <category>疑难杂症</category>
        <category>hexo</category>
        <item>
            <guid isPermalink="true">https://haysalan.github.io/posts/50605.html</guid>
            <title>破解tap验证和绕过实名认证</title>
            <link>https://haysalan.github.io/posts/50605.html</link>
            <category>入门级</category>
            <pubDate>Wed, 03 Jan 2024 10:13:01 +0000</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;案例目标&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#案例目标&#34;&gt;#&lt;/a&gt; 案例目标&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;去除账号验证&lt;/li&gt;
&lt;li&gt;去除实名认证&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;环境准备&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#环境准备&#34;&gt;#&lt;/a&gt; 环境准备&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;MT 管理器 / NP 管理器&lt;/li&gt;
&lt;li&gt;JEB/jadx（非必须）&lt;/li&gt;
&lt;li&gt;模拟器 / 安卓手机&lt;/li&gt;
&lt;li&gt;root （否）&lt;/li&gt;
&lt;li&gt;目标 APP&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;破解步骤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#破解步骤&#34;&gt;#&lt;/a&gt; 破解步骤&lt;/h2&gt;
&lt;h3 id=&#34;绕过账号验证&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#绕过账号验证&#34;&gt;#&lt;/a&gt; 绕过账号验证&lt;/h3&gt;
&lt;p&gt;开启 MT 管理器的 Activity 记录功能&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671602359155-c9ae5dc8-85b5-4231-94fb-a928eebcc0c3.png#averageHue=%23cac9c9&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=ucdad7e8c&amp;amp;originHeight=1206&amp;amp;originWidth=668&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=101736&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u51237a12-77fe-4d3d-965c-d5df7542f11&amp;amp;title=&#34; alt=&#34;微信截图_20221221135907.png&#34;&gt;&lt;br&gt;
 启动成功后打开我们需要破解的 APP，他会启动游戏平台验证账号，我们回到游戏就会看到下面的页面。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671602498061-e1426d46-45a5-4fac-8ebb-49e5ec366acb.png#averageHue=%23444444&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=u3e40e4a9&amp;amp;originHeight=739&amp;amp;originWidth=1356&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=67608&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u99f86d7f-d114-47aa-930c-33fcc39d0c5&amp;amp;title=&#34; alt=&#34;微信截图_20221221140124.png&#34;&gt;&lt;br&gt;
 进入 MT 管理器查看记录，最后的一个活动是 com.txxxxx.pay.sdk.library.TxxAlertDialog$1，那我们从它开始入手。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671602303415-c37264f8-df26-4454-8352-0e8e41a313b3.png#averageHue=%23c3c2c1&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=udfc026cc&amp;amp;originHeight=1298&amp;amp;originWidth=694&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=254366&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=udeaa1633-8f16-4d99-b3e5-929efbf8e92&amp;amp;title=&#34; alt=&#34;微信截图_20221221135806.png&#34;&gt;&lt;br&gt;
 找到这个类 com.txxxxx.pay.sdk.library.TxxAlertDialog&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671602871407-6ceb3b75-f65e-4c41-a429-95200bfad7db.png#averageHue=%23e7e3d7&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=u889397ae&amp;amp;originHeight=933&amp;amp;originWidth=1552&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=217684&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u45e25c5f-8765-4e4b-b9ff-fb14a6c7468&amp;amp;title=&#34; alt=&#34;微信截图_20221221140729.png&#34;&gt;&lt;br&gt;
 我们得到 new 它的地方。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671604604483-60b1bd9d-b7cc-4af6-bf09-65691a2f9037.png#averageHue=%23eae1d5&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=u8c895e75&amp;amp;originHeight=1079&amp;amp;originWidth=1567&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=211722&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ub2a5a9fd-f775-4796-add0-aad888f41b9&amp;amp;title=&#34; alt=&#34;微信截图_20221221143612.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;进入并分析一下。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671604759903-d6ad0476-9c68-4d05-8aac-7d5923ba3f27.png#averageHue=%23f3ebe3&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=u090dbc25&amp;amp;originHeight=1087&amp;amp;originWidth=1452&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=164088&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u121839ec-ce4b-4c71-99a3-a029bfa5e81&amp;amp;title=&#34; alt=&#34;微信截图_20221221143852.png&#34;&gt;&lt;br&gt;
 搜索一下哪里调用了销毁弹窗，验证通过必定需要销毁，找起来更快。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671604904388-35ec8f2a-0648-4fd1-89b0-2c81b69bf9bf.png#averageHue=%23f4f0ee&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=ueca1eb4e&amp;amp;originHeight=693&amp;amp;originWidth=1496&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=62436&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u9a91e773-032a-466e-962d-90dcc2a5958&amp;amp;title=&#34; alt=&#34;微信截图_20221221144127.png&#34;&gt;&lt;br&gt;
 进入分析一下。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671605052168-84dd2bde-fb9f-473e-b107-f74923303f3e.png#averageHue=%23f8f2f1&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=u72643f64&amp;amp;originHeight=366&amp;amp;originWidth=1450&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=56786&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u6055ff4c-1c26-4b48-b25b-074bf528857&amp;amp;title=&#34; alt=&#34;微信截图_20221221144342.png&#34;&gt;&lt;br&gt;
 看看哪里还个调用了&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671605447575-ce5982d8-35b3-43ef-9d78-260b576d4406.png#averageHue=%23f3f0ea&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=u2d5ce57b&amp;amp;originHeight=916&amp;amp;originWidth=1535&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=107223&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u40fd5ad3-e7ba-48b1-abcd-d2f0a1bed06&amp;amp;title=&#34; alt=&#34;微信截图_20221221145005.png&#34;&gt;&lt;br&gt;
 这里我验证过了，修改它们即可去除验证。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671605720530-3d2f6cd3-821d-4a38-9577-472b65688caa.png#averageHue=%23faf5f4&amp;amp;clientId=u3218cd6c-2e71-4&amp;amp;from=ui&amp;amp;id=u7e1cfcac&amp;amp;originHeight=1141&amp;amp;originWidth=1406&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=122503&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u859a70bf-d132-46f9-bf73-82676b18f83&amp;amp;title=&#34; alt=&#34;微信截图_20221221145500.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;快速定位关键字 &lt;code&gt;checkLicense = licensed&lt;/code&gt;  (不出意外只有一个结果)&lt;br&gt;
 然后搜索定位函数 checkLicense&lt;br&gt;
 在 smali 代码中修改对应的值就能去除验证了。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671532241058-89eb95d0-d5a6-4f7d-81c1-cdbc7457985b.png#averageHue=%23fdfaf9&amp;amp;clientId=u5760c920-5b5f-4&amp;amp;from=drop&amp;amp;id=FZP8r&amp;amp;originHeight=1176&amp;amp;originWidth=1672&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=170926&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ue6c970bb-1886-4050-b0ae-6bbb13fcdac&amp;amp;title=&#34; alt=&#34;微信截图_20221220183011.png&#34;&gt;&lt;br&gt;
 重新签名安装后启动看看效果吧。&lt;/p&gt;
&lt;h3 id=&#34;绕过实名认证&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#绕过实名认证&#34;&gt;#&lt;/a&gt; 绕过实名认证&lt;/h3&gt;
&lt;p&gt;开启 MT 管理器的 Activity 记录功能，然后启动 APP 弹出实名弹窗之后回到 MT 管理器，可以看到只有一个 Activity -&amp;gt;  &lt;code&gt;com.lixxthgame.abi.UnityPlayerActivity&lt;/code&gt; &lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671588848878-0441652c-c8a9-49fa-b4b6-b8e7486d6fed.png#averageHue=%238b8a8a&amp;amp;clientId=u2e0d459e-147d-4&amp;amp;from=ui&amp;amp;id=ua42b506b&amp;amp;originHeight=1121&amp;amp;originWidth=678&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=166629&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u8cdbd2c8-dbd3-4305-96f6-d6b64c57410&amp;amp;title=&#34; alt=&#34;Snipaste_2022-12-21_10-11-13.png&#34;&gt;&lt;br&gt;
 在 UnityPlayerActivity 中并没发现什么可疑的地方，那就得找新的办法了。&lt;br&gt;
我们来试试新的关键字 “identify”，需要实名认证，估计会使用这个单词。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671593032964-ab95b599-8b44-4474-a4fb-6bfb0b60ecca.png#averageHue=%23ebe8e5&amp;amp;clientId=u2e0d459e-147d-4&amp;amp;from=ui&amp;amp;id=u058e6d36&amp;amp;originHeight=1153&amp;amp;originWidth=1581&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=231954&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ue65d47f3-f7d1-40f0-95f9-8c11014a99e&amp;amp;title=&#34; alt=&#34;微信截图_20221221112340.png&#34;&gt;&lt;br&gt;
 看看这个 IdentifyHelp 类是干什么用的。&lt;/p&gt;
&lt;p&gt;IdentifyHelp 中有个方法 CompareTimeUp18 翻译过来就是 对比年龄到 18（估计是用出生日期和当前时间对比）&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671593371902-50de2adf-4bde-4121-8ec3-741a4df678aa.png#averageHue=%23fbf7f6&amp;amp;clientId=u2e0d459e-147d-4&amp;amp;from=ui&amp;amp;id=u537bd713&amp;amp;originHeight=346&amp;amp;originWidth=1456&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=40390&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=uec1358ce-5d27-46fa-a000-cc3c94241fe&amp;amp;title=&#34; alt=&#34;微信截图_20221221112821.png&#34;&gt;&lt;br&gt;
 看看那些地方调用了 CompareTimeUp18&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671593917788-ab9501b3-bda6-4746-aabf-699cbb8c4681.png#averageHue=%23f1eeeb&amp;amp;clientId=u2e0d459e-147d-4&amp;amp;from=ui&amp;amp;id=u4a635499&amp;amp;originHeight=1148&amp;amp;originWidth=1582&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=133303&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u9aa9b69b-708f-401f-899d-6116db127f1&amp;amp;title=&#34; alt=&#34;微信截图_20221221113824.png&#34;&gt;&lt;br&gt;
 选择第一个，进入到方法 antiAddication，分析一下。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671595264762-5395591c-b7fa-42f5-b365-4d8dc36208e1.png#averageHue=%23f7f1ef&amp;amp;clientId=u2e0d459e-147d-4&amp;amp;from=ui&amp;amp;id=u8027d24a&amp;amp;originHeight=959&amp;amp;originWidth=1449&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=164814&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ub95c164f-e498-45d0-b5e7-2c8198e9239&amp;amp;title=&#34; alt=&#34;微信截图_20221221120045.png&#34;&gt;&lt;br&gt;
 进入 setBigMan 或 setIdenfity 中&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671594735893-520b3df9-6c33-41b1-8eba-59e9feab47ba.png#averageHue=%23fcf8f7&amp;amp;clientId=u2e0d459e-147d-4&amp;amp;from=ui&amp;amp;id=u483aba0b&amp;amp;originHeight=1064&amp;amp;originWidth=995&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=83011&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=uccd0dc22-b3dc-44bb-b67e-ae4e734b216&amp;amp;title=&#34; alt=&#34;微信截图_20221221115204.png&#34;&gt;&lt;br&gt;
 将 isBigMan 和 isIdenfity 的初始值置为 true 即可去实名认证了。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671591338615-f3e424d9-7255-40c5-b067-160fd53e9272.png#averageHue=%23fbf9f9&amp;amp;clientId=u2e0d459e-147d-4&amp;amp;from=ui&amp;amp;id=D2g7d&amp;amp;originHeight=1087&amp;amp;originWidth=979&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=101242&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u48e415f1-34d6-4730-a542-f28400787b2&amp;amp;title=&#34; alt=&#34;微信截图_20221221105523.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;在 smali 代码中修改对应的值就能去除验证了。&lt;br&gt;
快速定位关键字  &lt;code&gt;LoaclUser&amp;#123;name=&lt;/code&gt;  (不出意外只有一个结果)&lt;br&gt;
 搜索定位 isIdenfity&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2022/png/26634545/1671591845525-464035cb-38f4-480d-8e91-8375683bb4a5.png#averageHue=%23fdf3f1&amp;amp;clientId=u2e0d459e-147d-4&amp;amp;from=ui&amp;amp;id=UGMOJ&amp;amp;originHeight=511&amp;amp;originWidth=1513&amp;amp;originalType=binary%E2%88%B6=1&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=71430&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ua65fb48e-9e12-4d70-85f9-5dd795a4a49&amp;amp;title=&#34; alt=&#34;微信截图_20221221110343.png&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://haysalan.github.io/posts/26899.html</guid>
            <title>小破站老版本（入门级）SO层Native方法分析</title>
            <link>https://haysalan.github.io/posts/26899.html</link>
            <category>frida</category>
            <category>SO</category>
            <category>Native</category>
            <category>入门级</category>
            <pubDate>Sat, 09 Dec 2023 01:25:03 +0000</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;准备工作&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#准备工作&#34;&gt;#&lt;/a&gt; 准备工作&lt;/h1&gt;
&lt;p&gt;APK：哔哩哔哩 6.13.0&lt;br&gt;
 首先通过 charles 抓包（&lt;a href=&#34;/2023/12/14/yuque/charles%E7%A7%BB%E5%8A%A8&amp;amp;PC%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/&#34;&gt;charles 抓包配置&lt;/a&gt;）发现加密参数是 sign（32 位）。&lt;br&gt;
&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1702545110875-4f85f617-f9b8-41f3-a026-5225f1ecb6fa.png#averageHue=%23efebe7&amp;amp;clientId=u38bf89dd-3cf3-4&amp;amp;from=paste&amp;amp;height=182&amp;amp;id=ud746971e&amp;amp;originHeight=273&amp;amp;originWidth=699&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=27817&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u0382f2ee-b150-43bf-8767-3f42b87f7c9&amp;amp;title=&amp;amp;width=466&#34; alt=&#34;image.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;使用 ajdx 打开 apk 后搜索 &amp;quot;sign&amp;quot; 并没有想要的数据，接着试着搜索 &amp;quot;sign=&amp;quot; 经过分析发现是 &lt;code&gt;com.bilibili.nativelibrary.LibBili.s&lt;/code&gt;  生成。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1702546159027-aa401add-1412-4a36-85ec-25f0ed79ab6b.png#averageHue=%23fdf8f6&amp;amp;clientId=u38bf89dd-3cf3-4&amp;amp;from=paste&amp;amp;height=341&amp;amp;id=ubff81967&amp;amp;originHeight=512&amp;amp;originWidth=873&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=36640&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ua7d5337b-80c2-4ec6-9747-241d38418ae&amp;amp;title=&amp;amp;width=582&#34; alt=&#34;image.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;验证加密&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#验证加密&#34;&gt;#&lt;/a&gt; 验证加密&lt;/h1&gt;
&lt;p&gt;使用 frida 来 hook 验证以下&lt;/p&gt;
&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;hookSign&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;title class_&#34;&gt;Java&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;perform&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; (&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;LibBili&lt;/span&gt; = &lt;span class=&#34;title class_&#34;&gt;Java&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;use&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;com.bilibili.nativelibrary.LibBili&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;title class_&#34;&gt;LibBili&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;quot;s&amp;quot;&lt;/span&gt;].&lt;span class=&#34;property&#34;&gt;implementation&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; (&lt;span class=&#34;params&#34;&gt;sortedMap&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;variable language_&#34;&gt;console&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;log&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;string&#34;&gt;`LibBili.s is called: sortedMap=&lt;span class=&#34;subst&#34;&gt;$&amp;#123;sortedMap.entrySet().toArray()&amp;#125;&lt;/span&gt;`&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; result = &lt;span class=&#34;variable language_&#34;&gt;this&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;quot;s&amp;quot;&lt;/span&gt;](sortedMap);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;variable language_&#34;&gt;console&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;log&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;`LibBili.s result=&lt;span class=&#34;subst&#34;&gt;$&amp;#123;result&amp;#125;&lt;/span&gt;`&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; result;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_&#34;&gt;setImmediate&lt;/span&gt;(hookSign);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;frida hook 日志，很明显 sign 就是在这里面生成的。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;[MI 8 Pro::tv.danmaku.bili ]-&amp;gt; LibBili.s is called: sortedMap=access_key=null,appkey=1d8b6e7d45233436,build=6130400,c_locale=zh-Hans_CN,channel=xxl_wyyd_001,mVersion=71,mallVersion=6130400,mobi_app=android,platform=android,s_locale=zh-Hans_CN,statistics=&amp;#123;&amp;quot;appId&amp;quot;:1,&amp;quot;platform&amp;quot;:3,&amp;quot;version&amp;quot;:&amp;quot;6.13.0&amp;quot;,&amp;quot;abtest&amp;quot;:&amp;quot;&amp;quot;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;LibBili.s result=access_key=&amp;amp;appkey=1d8b6e7d45233436&amp;amp;build=6130400&amp;amp;c_locale=zh-Hans_CN&amp;amp;channel=xxl_wyyd_001&amp;amp;mVersion=71&amp;amp;mallVersion=6130400&amp;amp;mobi_app=android&amp;amp;platform=android&amp;amp;s_locale=zh-Hans_CN&amp;amp;statistics=%7B%22appId%22%3A1%2C%22platform%22%3A3%2C%22version%22%3A%226.13.0%22%2C%22abtest%22%3A%22%22%7D&amp;amp;ts=1702547190&amp;amp;sign=83c0620895711a111a4fc8f046b76d9d&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&#34;定位-so&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#定位-so&#34;&gt;#&lt;/a&gt; 定位 SO&lt;/h1&gt;
&lt;p&gt;使用大佬的&lt;a href=&#34;https://github.com/lasting-yang/frida_hook_libart/blob/master/hook_RegisterNatives.js&#34;&gt; hook 脚本&lt;/a&gt;并作了点修改&lt;/p&gt;
&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;hook_RegisterNatives&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; symbols = &lt;span class=&#34;title class_&#34;&gt;Module&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;enumerateSymbolsSync&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;libart.so&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; addrRegisterNatives = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; symbols.&lt;span class=&#34;property&#34;&gt;length&lt;/span&gt;; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; symbol = symbols[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//_ZN3art3JNI15RegisterNativesEP7_JNIEnvP7_jclassPK15JNINativeMethodi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      symbol.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;indexOf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;art&amp;quot;&lt;/span&gt;) &amp;gt;= &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      symbol.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;indexOf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;JNI&amp;quot;&lt;/span&gt;) &amp;gt;= &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      symbol.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;indexOf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;RegisterNatives&amp;quot;&lt;/span&gt;) &amp;gt;= &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      symbol.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;indexOf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;CheckJNI&amp;quot;&lt;/span&gt;) &amp;lt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      addrRegisterNatives = symbol.&lt;span class=&#34;property&#34;&gt;address&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;variable language_&#34;&gt;console&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;log&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;RegisterNatives is at &amp;quot;&lt;/span&gt;, symbol.&lt;span class=&#34;property&#34;&gt;address&lt;/span&gt;, symbol.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (addrRegisterNatives != &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;title class_&#34;&gt;Interceptor&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;attach&lt;/span&gt;(addrRegisterNatives, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;attr&#34;&gt;onEnter&lt;/span&gt;: &lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; (&lt;span class=&#34;params&#34;&gt;args&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; env = args[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; java_class = args[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; class_name = &lt;span class=&#34;title class_&#34;&gt;Java&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;vm&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;tryGetEnv&lt;/span&gt;().&lt;span class=&#34;title function_&#34;&gt;getClassName&lt;/span&gt;(java_class);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// console.log(class_name);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// 筛选类&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; taget_class = &lt;span class=&#34;string&#34;&gt;&amp;quot;com.bilibili.nativelibrary.LibBili&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (class_name === taget_class) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              &lt;span class=&#34;variable language_&#34;&gt;console&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;log&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;\n[RegisterNatives] method_count:&amp;quot;&lt;/span&gt;, args[&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; methods_ptr = &lt;span class=&#34;title function_&#34;&gt;ptr&lt;/span&gt;(args[&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; method_count = &lt;span class=&#34;built_in&#34;&gt;parseInt&lt;/span&gt;(args[&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; method_count; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; name_ptr = &lt;span class=&#34;title class_&#34;&gt;Memory&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;readPointer&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  methods_ptr.&lt;span class=&#34;title function_&#34;&gt;add&lt;/span&gt;(i * &lt;span class=&#34;title class_&#34;&gt;Process&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;pointerSize&lt;/span&gt; * &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; sig_ptr = &lt;span class=&#34;title class_&#34;&gt;Memory&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;readPointer&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  methods_ptr.&lt;span class=&#34;title function_&#34;&gt;add&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    i * &lt;span class=&#34;title class_&#34;&gt;Process&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;pointerSize&lt;/span&gt; * &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt; + &lt;span class=&#34;title class_&#34;&gt;Process&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;pointerSize&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; fnPtr_ptr = &lt;span class=&#34;title class_&#34;&gt;Memory&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;readPointer&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  methods_ptr.&lt;span class=&#34;title function_&#34;&gt;add&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    i * &lt;span class=&#34;title class_&#34;&gt;Process&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;pointerSize&lt;/span&gt; * &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt; + &lt;span class=&#34;title class_&#34;&gt;Process&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;pointerSize&lt;/span&gt; * &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; name = &lt;span class=&#34;title class_&#34;&gt;Memory&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;readCString&lt;/span&gt;(name_ptr);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; sig = &lt;span class=&#34;title class_&#34;&gt;Memory&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;readCString&lt;/span&gt;(sig_ptr);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; find_module = &lt;span class=&#34;title class_&#34;&gt;Process&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;findModuleByAddress&lt;/span&gt;(fnPtr_ptr);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable language_&#34;&gt;console&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;log&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  &lt;span class=&#34;string&#34;&gt;&amp;quot;[RegisterNatives] java_class:&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  class_name,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  &lt;span class=&#34;string&#34;&gt;&amp;quot;name:&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  name,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  &lt;span class=&#34;string&#34;&gt;&amp;quot;sig:&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  sig,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  &lt;span class=&#34;string&#34;&gt;&amp;quot;fnPtr:&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  fnPtr_ptr,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  &lt;span class=&#34;string&#34;&gt;&amp;quot;module_name:&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  find_module.&lt;span class=&#34;property&#34;&gt;name&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  &lt;span class=&#34;string&#34;&gt;&amp;quot;module_base:&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  find_module.&lt;span class=&#34;property&#34;&gt;base&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  &lt;span class=&#34;string&#34;&gt;&amp;quot;offset:&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                  &lt;span class=&#34;title function_&#34;&gt;ptr&lt;/span&gt;(fnPtr_ptr).&lt;span class=&#34;title function_&#34;&gt;sub&lt;/span&gt;(find_module.&lt;span class=&#34;property&#34;&gt;base&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_&#34;&gt;setImmediate&lt;/span&gt;(hook_RegisterNatives);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;添加筛选条件后输出的结果不多&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Spawning `tv.danmaku.bili`...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;RegisterNatives is at  0xf0b3cbd9 _ZN3art3JNIILb0EE15RegisterNativesEP7_JNIEnvP7_jclassPK15JNINativeMethodi&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;RegisterNatives is at  0xf0b910d5 _ZN3art3JNIILb1EE15RegisterNativesEP7_JNIEnvP7_jclassPK15JNINativeMethodi&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Spawned `tv.danmaku.bili`. Resuming main thread!&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[MI 8 Pro::tv.danmaku.bili ]-&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] method_count: 0x7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] java_class: com.bilibili.nativelibrary.LibBili name: a sig: (Ljava/lang/String;)Ljava/lang/String; fnPtr: 0xb8369c35 module_name: libbili.so module_base: 0xb8368000 offset: 0x1c35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] java_class: com.bilibili.nativelibrary.LibBili name: ao sig: (Ljava/lang/String;II)Ljava/lang/String; fnPtr: 0xb8369c3b module_name: libbili.so module_base: 0xb8368000 offset: 0x1c3b&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] java_class: com.bilibili.nativelibrary.LibBili name: b sig: (Ljava/lang/String;)Ljavax/crypto/spec/IvParameterSpec; fnPtr: 0xb8369c49 module_name: libbili.so module_base: 0xb8368000 offset: 0x1c49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] java_class: com.bilibili.nativelibrary.LibBili name: s sig: (Ljava/util/SortedMap;)Lcom/bilibili/nativelibrary/SignedQuery; fnPtr: 0xb8369c4f module_name: libbili.so module_base: 0xb8368000 offset: 0x1c4f&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] java_class: com.bilibili.nativelibrary.LibBili name: so sig: (Ljava/util/SortedMap;II)Lcom/bilibili/nativelibrary/SignedQuery; fnPtr: 0xb8369c55 module_name: libbili.so module_base: 0xb8368000 offset: 0x1c55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] java_class: com.bilibili.nativelibrary.LibBili name: getCpuCount sig: ()I fnPtr: 0xb8369c63 module_name: libbili.so module_base: 0xb8368000 offset: 0x1c63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] java_class: com.bilibili.nativelibrary.LibBili name: getCpuId sig: ()I fnPtr: 0xb8369c67 module_name: libbili.so module_base: 0xb8368000 offset: 0x1c67&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这就是我们需要的结果，module_name: &lt;a href=&#34;http://libbili.so&#34;&gt;libbili.so&lt;/a&gt; 表示 s 函数在 &lt;strong&gt;&lt;a href=&#34;http://libbili.so&#34;&gt;libbili.so&lt;/a&gt;&lt;/strong&gt; 中。&lt;br&gt;
offset: 0x1c4f 偏移量为 0x1c4f 可以理解为函数起始地址。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;[RegisterNatives] java_class: com.bilibili.nativelibrary.LibBili name: s sig: (Ljava/util/SortedMap;)Lcom/bilibili/nativelibrary/SignedQuery; fnPtr: 0xb8369c4f module_name: libbili.so module_base: 0xb8368000 offset: 0x1c4f&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&#34;分析-so&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#分析-so&#34;&gt;#&lt;/a&gt; 分析 SO&lt;/h1&gt;
&lt;p&gt;使用&lt;strong&gt; file&lt;/strong&gt; 命令查看 so 的位数是多少位，可以看到是 32 位的，那么使用 32 位的 ida 打开。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/png/26634545/1702545860250-d8c98fed-5255-4a16-947a-c16016a59d92.png#averageHue=%232e3039&amp;amp;clientId=u38bf89dd-3cf3-4&amp;amp;from=paste&amp;amp;height=72&amp;amp;id=u4365b7e2&amp;amp;originHeight=108&amp;amp;originWidth=1195&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=31218&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=uae38cbac-a117-4898-9e10-2e4569eeff4&amp;amp;title=&amp;amp;width=796.6666666666666&#34; alt=&#34;image.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;偏移量地址定位函数&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#偏移量地址定位函数&#34;&gt;#&lt;/a&gt; 偏移量地址定位函数&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/gif/26634545/1702550208616-9e78b5a6-c72b-4f48-bd9f-75b6684b755b.gif#averageHue=%23f7f7f6&amp;amp;clientId=u26f63c50-11da-4&amp;amp;from=drop&amp;amp;id=u1e1c6921&amp;amp;originHeight=1328&amp;amp;originWidth=2053&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=454668&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=ua43a4d49-06e5-478f-ac28-235419421ac&amp;amp;title=&#34; alt=&#34;PixPin_2023-12-14_18-36-22.gif&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;jni_onload-定位-s-函数&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#jni_onload-定位-s-函数&#34;&gt;#&lt;/a&gt; JNI_OnLoad 定位 s 函数&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://cdn.nlark.com/yuque/0/2023/gif/26634545/1702550232510-9c4a4843-75f5-4fce-a183-770783c0dddb.gif#averageHue=%23f6f6f5&amp;amp;clientId=u26f63c50-11da-4&amp;amp;from=drop&amp;amp;id=u5aefa470&amp;amp;originHeight=1328&amp;amp;originWidth=2053&amp;amp;originalType=binary%E2%88%B6=1.5&amp;amp;rotation=0&amp;amp;showTitle=false&amp;amp;size=792808&amp;amp;status=done&amp;amp;style=none&amp;amp;taskId=u3e2d9528-de56-415e-9185-2b963fb96eb&amp;amp;title=&#34; alt=&#34;PixPin_2023-12-14_18-32-47.gif&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
    </channel>
</rss>
